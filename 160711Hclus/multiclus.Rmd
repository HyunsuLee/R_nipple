---
title: "multi_cluster"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

## Data load & libary load

```{r, echo = FALSE}
require(reshape2)
require(gplots)
require(preprocessCore)


d <- read.table("rawdata_fpkm_beforecorrection.txt", header = TRUE)
```

## data process
```{r, echo=FALSE}
d.m <- as.matrix(d)

d.m = d.m + 1

d.m.log <- log10(d.m)

d.m.log.nq <- normalize.quantiles(d.m.log)
colnames(d.m.log.nq) <- colnames(d.m.log)
rownames(d.m.log.nq) <- rownames(d.m.log)

# data exporting. R too slow to process correlation matrix.
write.table(d.m.log.nq, file = "log_nq.txt")
```

## clustering for heatmap
```{r, echo=FALSE}
# correlation clustering
cor_t <-cor(t(d.m.log.nq))
cor_t.dist <-dist(d.m.log.nq)
cor_hclu_avg <-hclust(cor_t.dist, method = "average")
cor_hclu_com <-hclust(cor_t.dist, method = "complete")
cor_hclu_ward <-hclust(cor_t.dist, method = "ward.D2")



```

