---
title: "multi_cluster"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

## Data load & libary load

```{r, echo = FALSE}
require(reshape2)
require(gplots)
require(preprocessCore)
require(bigmemory)

d <- read.table("rawdata_fpkm_beforecorrection.txt", header = TRUE)
```

## data process
```{r, echo=FALSE}
dMat <- as.matrix(d)

dMat = dMat + 1

dMatLog <- log10(dMat)

dMatLogNQ <- normalize.quantiles(dMatLog)
colnames(dMatLogNQ) <- colnames(dMatLog)
rownames(dMatLogNQ) <- rownames(dMatLog)

# data exporting. R too slow to process correlation matrix.
write.csv(dMatLogNQ, file = "log_nq.csv")
```

## clustering for heatmap
```{r, echo=FALSE}
# correlation clustering
# cor <- as.big.matrix(dMatLogNQ)
corDist <-dist(dMatLogNQ)
corHCluAVG <-hclust(corDist, method = "average")
corHCluCOM <-hclust(corDist, method = "complete")
corHCluWARD <-hclust(corDist, method = "ward.D2")



```

