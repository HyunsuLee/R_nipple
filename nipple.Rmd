---
title: "Nipple"
author: "Hyunsu Lee"
date: "April 30, 2016"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

## Data load & summary
```{r, echo=FALSE}
require(ggplot2)
nipple <- read.csv("nippleKrp_Wt.csv", header = TRUE)
##head(nipple)

```

## Data subsetting
```{r, echo=FALSE}

nipplefulvar <- colnames(nipple)
nipplesubvar <- nipplefulvar[1:14]
nipplesub <- nipple[nipplesubvar]
colnames(nipplesub) <- c("id","der1", "der2", "der3", "wt1", "wt2","wt3","der_avr","wt_avr", "der_wt","Fold_change", "gene.acc","gene.symbol","gene.desc")
nipplesub.deg <- subset(nipplesub, Fold_change > 1.5 | Fold_change <0.67)
# nipplesub.t <-t(nipplesub[2:7]) # matrix transpose, col에 gene, raw에 실험이 가도록
nipplesub.deg.t <-t(nipplesub.deg[2:7])
# gene.sym <- nipplesub$gene.symbol
# colnames(nipplesub.t) <- gene.sym # column name을 gene symbol로 바꿈.
gene.sym.deg <- nipplesub.deg$gene.symbol
colnames(nipplesub.deg.t) <- gene.sym.deg
```

## PCA
```{r, echo=FALSE}
'''
nipple.pca <- prcomp(nipplesub.t, scale=TRUE) # PCA 시행.
summary(nipple.pca, scale = TRUE)
screeplot(nipple.pca, scale =TRUE)
biplot(nipple.pca)
'''
nipple.pca.deg <- prcomp(nipplesub.deg.t, scale. =TRUE) # PCA 시행.
summary(nipple.pca.deg, scale. = TRUE)
screeplot(nipple.pca.deg)
nipple.pca.deg.var = nipple.pca.deg$sdev ^ 2 # 주성분들의 분산 계산
nipple.pca.deg.pve = nipple.pca.deg.var / sum(nipple.pca.deg.var) #주성분 분산의 propotion 계산
plot (nipple.pca.deg.pve, xlab = "Principal Component", ylab = "Propotion of Variance Explained", ylim = c(0,1), type = "b")
PCA.scores = nipple.pca.deg$x
# biplot(nipple.pca.deg, var.axes = FALSE, scale = 1, pc.biplot = FALSE)
PCA.scores.df = data.frame(PCA.scores)
g <- ggplot(PCA.scores.df, aes(PC1,PC2), label = rownames(PCA.scores.df) , size=I(3)) + geom_point(aes(colours = rownames(PCA.scores.df)))

g <- g + scale_color_manual(values = c("orange","red", "pink", "blue", "black", "purple")) +theme(legend.position="none")
g <- geom_text(aes(colour = rownames(PCA.scores.df)), label = rownames(PCA.scores.df), nudge_x = 5)

g + scale_color_manual(values = c("orange","red", "pink", "blue", "black", "purple"))

```


